import { QueryClient } from "/@fs/Users/thibault/Développements /CJD80/cjd80/node_modules/.vite/deps/@tanstack_react-query.js?v=27047fab";
import { wrapApiRequest } from "/src/lib/sync-service.ts";
async function throwIfResNotOk(res) {
  if (!res.ok) {
    const text = await res.text() || res.statusText;
    throw new Error(`${res.status}: ${text}`);
  }
}
export async function apiRequest(method, url, data) {
  const res = await fetch(url, {
    method,
    headers: data ? { "Content-Type": "application/json" } : {},
    body: data ? JSON.stringify(data) : void 0,
    credentials: "include"
  });
  await throwIfResNotOk(res);
  return res;
}
export async function apiRequestWithOfflineSupport(method, url, data) {
  const res = await wrapApiRequest(method, url, data);
  if (res.status !== 202) {
    await throwIfResNotOk(res);
  }
  return res;
}
export const getQueryFn = ({ on401: unauthorizedBehavior }) => async ({ queryKey }) => {
  const res = await fetch(queryKey.join("/"), {
    credentials: "include"
  });
  if (unauthorizedBehavior === "returnNull" && res.status === 401) {
    return null;
  }
  await throwIfResNotOk(res);
  const json = await res.json();
  if (json && typeof json === "object" && "success" in json && "data" in json) {
    return json.data;
  }
  return json;
};
export const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      queryFn: getQueryFn({ on401: "throw" }),
      refetchInterval: false,
      refetchOnWindowFocus: false,
      // Cache optimisé : 5 minutes de staleTime, 10 minutes de cache
      staleTime: 5 * 60 * 1e3,
      gcTime: 10 * 60 * 1e3,
      retry: 2,
      retryDelay: (attemptIndex) => Math.min(1e3 * 2 ** attemptIndex, 3e4)
    },
    mutations: {
      retry: 1
    }
  }
});
export function invalidateAndRefetch(queryKey) {
  queryClient.invalidateQueries({ queryKey });
  queryClient.refetchQueries({ queryKey });
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInF1ZXJ5Q2xpZW50LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFF1ZXJ5Q2xpZW50LCBRdWVyeUZ1bmN0aW9uIH0gZnJvbSBcIkB0YW5zdGFjay9yZWFjdC1xdWVyeVwiO1xuaW1wb3J0IHsgd3JhcEFwaVJlcXVlc3QgfSBmcm9tIFwiLi9zeW5jLXNlcnZpY2VcIjtcblxuYXN5bmMgZnVuY3Rpb24gdGhyb3dJZlJlc05vdE9rKHJlczogUmVzcG9uc2UpIHtcbiAgaWYgKCFyZXMub2spIHtcbiAgICBjb25zdCB0ZXh0ID0gKGF3YWl0IHJlcy50ZXh0KCkpIHx8IHJlcy5zdGF0dXNUZXh0O1xuICAgIHRocm93IG5ldyBFcnJvcihgJHtyZXMuc3RhdHVzfTogJHt0ZXh0fWApO1xuICB9XG59XG5cbi8qKlxuICogU3RhbmRhcmQgQVBJIHJlcXVlc3QgZnVuY3Rpb24gLSBtYWtlcyBkaXJlY3QgcmVxdWVzdHMgd2l0aG91dCBvZmZsaW5lIHN1cHBvcnRcbiAqIFxuICogVGhpcyBpcyB0aGUgZGVmYXVsdCBmdW5jdGlvbiBmb3IgYWxsIEFQSSByZXF1ZXN0cy4gSXQgdGhyb3dzIGVycm9ycyBpbW1lZGlhdGVseVxuICogd2hlbiByZXF1ZXN0cyBmYWlsLCB3aGljaCBpcyB0aGUgZXhwZWN0ZWQgYmVoYXZpb3IgZm9yIG1vc3QgdXNlIGNhc2VzLlxuICogXG4gKiBGb3Igb2ZmbGluZSBzdXBwb3J0LCB1c2UgYGFwaVJlcXVlc3RXaXRoT2ZmbGluZVN1cHBvcnRgIGFzIGFuIG9wdC1pbiBhbHRlcm5hdGl2ZS5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFwaVJlcXVlc3QoXG4gIG1ldGhvZDogc3RyaW5nLFxuICB1cmw6IHN0cmluZyxcbiAgZGF0YT86IHVua25vd24gfCB1bmRlZmluZWQsXG4pOiBQcm9taXNlPFJlc3BvbnNlPiB7XG4gIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKHVybCwge1xuICAgIG1ldGhvZCxcbiAgICBoZWFkZXJzOiBkYXRhID8geyBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIiB9IDoge30sXG4gICAgYm9keTogZGF0YSA/IEpTT04uc3RyaW5naWZ5KGRhdGEpIDogdW5kZWZpbmVkLFxuICAgIGNyZWRlbnRpYWxzOiBcImluY2x1ZGVcIixcbiAgfSk7XG5cbiAgYXdhaXQgdGhyb3dJZlJlc05vdE9rKHJlcyk7XG4gIHJldHVybiByZXM7XG59XG5cbi8qKlxuICogQVBJIHJlcXVlc3Qgd2l0aCBvZmZsaW5lIHN1cHBvcnQgKE9QVC1JTiBGRUFUVVJFKVxuICogXG4gKiBUaGlzIGlzIGFuIE9QVElPTkFMIGFsdGVybmF0aXZlIHRvIGFwaVJlcXVlc3QgdGhhdCBwcm92aWRlcyBvZmZsaW5lIGZ1bmN0aW9uYWxpdHkuXG4gKiBPbmx5IHVzZSB0aGlzIHdoZW4geW91IHNwZWNpZmljYWxseSBuZWVkIG9mZmxpbmUgc3VwcG9ydCBmb3IgbXV0YXRpb25zLlxuICogXG4gKiBCZWhhdmlvcjpcbiAqIC0gV2hlbiBvbmxpbmU6IE1ha2VzIG5vcm1hbCBBUEkgcmVxdWVzdHMgKHNhbWUgYXMgYXBpUmVxdWVzdClcbiAqIC0gV2hlbiBvZmZsaW5lOiBRdWV1ZXMgbXV0YXRpb25zIGluIEluZGV4ZWREQiBhbmQgcmV0dXJucyBhIG1vY2tlZCBzdWNjZXNzIHJlc3BvbnNlXG4gKiAtIFdoZW4gY29ubmVjdGlvbiByZXN0b3JlZDogQXV0b21hdGljYWxseSBzeW5jcyBxdWV1ZWQgYWN0aW9uc1xuICogXG4gKiBUaGUgbW9ja2VkIHJlc3BvbnNlIGhhcyBzdGF0dXMgMjAyIChBY2NlcHRlZCkgYW5kIGluY2x1ZGVzIGEgYHF1ZXVlZDogdHJ1ZWAgZmxhZy5cbiAqIFxuICogVXNhZ2U6IFJlcGxhY2UgYXBpUmVxdWVzdCB3aXRoIHRoaXMgZnVuY3Rpb24gaW4gbXV0YXRpb25zIHRoYXQgbmVlZCBvZmZsaW5lIHN1cHBvcnRcbiAqIEV4YW1wbGU6XG4gKiAgIGNvbnN0IG11dGF0aW9uID0gdXNlTXV0YXRpb24oe1xuICogICAgIG11dGF0aW9uRm46IGFzeW5jIChkYXRhKSA9PiB7XG4gKiAgICAgICBjb25zdCByZXMgPSBhd2FpdCBhcGlSZXF1ZXN0V2l0aE9mZmxpbmVTdXBwb3J0KFwiUE9TVFwiLCBcIi9hcGkvdm90ZXNcIiwgZGF0YSk7XG4gKiAgICAgICByZXR1cm4gYXdhaXQgcmVzLmpzb24oKTtcbiAqICAgICB9LFxuICogICAgIG9uU3VjY2VzczogKHJlc3VsdCkgPT4ge1xuICogICAgICAgaWYgKHJlc3VsdC5xdWV1ZWQpIHtcbiAqICAgICAgICAgLy8gSGFuZGxlIHF1ZXVlZCBzdGF0ZSAtIHNob3cgdXNlciB0aGF0IGFjdGlvbiB3aWxsIHN5bmMgbGF0ZXJcbiAqICAgICAgIH1cbiAqICAgICB9XG4gKiAgIH0pO1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXBpUmVxdWVzdFdpdGhPZmZsaW5lU3VwcG9ydChcbiAgbWV0aG9kOiBzdHJpbmcsXG4gIHVybDogc3RyaW5nLFxuICBkYXRhPzogdW5rbm93biB8IHVuZGVmaW5lZCxcbik6IFByb21pc2U8UmVzcG9uc2U+IHtcbiAgY29uc3QgcmVzID0gYXdhaXQgd3JhcEFwaVJlcXVlc3QobWV0aG9kLCB1cmwsIGRhdGEpO1xuICBcbiAgLy8gT25seSB0aHJvdyBpZiBub3QgYSBxdWV1ZWQgcmVzcG9uc2UgKHN0YXR1cyAyMDIgbWVhbnMgcXVldWVkKVxuICBpZiAocmVzLnN0YXR1cyAhPT0gMjAyKSB7XG4gICAgYXdhaXQgdGhyb3dJZlJlc05vdE9rKHJlcyk7XG4gIH1cbiAgXG4gIHJldHVybiByZXM7XG59XG5cbnR5cGUgVW5hdXRob3JpemVkQmVoYXZpb3IgPSBcInJldHVybk51bGxcIiB8IFwidGhyb3dcIjtcbmV4cG9ydCBjb25zdCBnZXRRdWVyeUZuOiA8VD4ob3B0aW9uczoge1xuICBvbjQwMTogVW5hdXRob3JpemVkQmVoYXZpb3I7XG59KSA9PiBRdWVyeUZ1bmN0aW9uPFQ+ID1cbiAgKHsgb240MDE6IHVuYXV0aG9yaXplZEJlaGF2aW9yIH0pID0+XG4gIGFzeW5jICh7IHF1ZXJ5S2V5IH0pID0+IHtcbiAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChxdWVyeUtleS5qb2luKFwiL1wiKSBhcyBzdHJpbmcsIHtcbiAgICAgIGNyZWRlbnRpYWxzOiBcImluY2x1ZGVcIixcbiAgICB9KTtcblxuICAgIGlmICh1bmF1dGhvcml6ZWRCZWhhdmlvciA9PT0gXCJyZXR1cm5OdWxsXCIgJiYgcmVzLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBhd2FpdCB0aHJvd0lmUmVzTm90T2socmVzKTtcbiAgICBjb25zdCBqc29uID0gYXdhaXQgcmVzLmpzb24oKTtcbiAgICBcbiAgICAvLyBIYW5kbGUgYmFja2VuZCByZXNwb25zZSBmb3JtYXQge3N1Y2Nlc3M6IHRydWUsIGRhdGE6IFsuLi5dfVxuICAgIGlmIChqc29uICYmIHR5cGVvZiBqc29uID09PSAnb2JqZWN0JyAmJiAnc3VjY2VzcycgaW4ganNvbiAmJiAnZGF0YScgaW4ganNvbikge1xuICAgICAgcmV0dXJuIGpzb24uZGF0YTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGpzb247XG4gIH07XG5cbmV4cG9ydCBjb25zdCBxdWVyeUNsaWVudCA9IG5ldyBRdWVyeUNsaWVudCh7XG4gIGRlZmF1bHRPcHRpb25zOiB7XG4gICAgcXVlcmllczoge1xuICAgICAgcXVlcnlGbjogZ2V0UXVlcnlGbih7IG9uNDAxOiBcInRocm93XCIgfSksXG4gICAgICByZWZldGNoSW50ZXJ2YWw6IGZhbHNlLFxuICAgICAgcmVmZXRjaE9uV2luZG93Rm9jdXM6IGZhbHNlLFxuICAgICAgLy8gQ2FjaGUgb3B0aW1pc8OpIDogNSBtaW51dGVzIGRlIHN0YWxlVGltZSwgMTAgbWludXRlcyBkZSBjYWNoZVxuICAgICAgc3RhbGVUaW1lOiA1ICogNjAgKiAxMDAwLFxuICAgICAgZ2NUaW1lOiAxMCAqIDYwICogMTAwMCxcbiAgICAgIHJldHJ5OiAyLFxuICAgICAgcmV0cnlEZWxheTogKGF0dGVtcHRJbmRleDogbnVtYmVyKSA9PiBNYXRoLm1pbigxMDAwICogMiAqKiBhdHRlbXB0SW5kZXgsIDMwMDAwKSxcbiAgICB9LFxuICAgIG11dGF0aW9uczoge1xuICAgICAgcmV0cnk6IDEsXG4gICAgfSxcbiAgfSxcbn0pO1xuXG4vKipcbiAqIEludmFsaWRlIGV0IHJhZnJhw65jaGl0IGltbcOpZGlhdGVtZW50IGxlcyBxdWVyaWVzIGNvcnJlc3BvbmRhbnRlc1xuICogXG4gKiBJTVBPUlRBTlQ6IFV0aWxpc2V6IGNldHRlIGZvbmN0aW9uIGF1IGxpZXUgZGUgc2ltcGxlbWVudCBpbnZhbGlkYXRlUXVlcmllc1xuICogcG91ciBnYXJhbnRpciBxdWUgbGVzIGRvbm7DqWVzIHNlIG1ldHRlbnQgw6Agam91ciBpbW3DqWRpYXRlbWVudCwgbcOqbWUgYXZlY1xuICogdW4gc3RhbGVUaW1lIMOpbGV2w6kuXG4gKiBcbiAqIEBwYXJhbSBxdWVyeUtleSAtIExhIGNsw6kgZGUgcXVlcnkgw6AgaW52YWxpZGVyIChwZXV0IMOqdHJlIHBhcnRpZWxsZSBwb3VyIGludmFsaWRlciBwbHVzaWV1cnMgcXVlcmllcylcbiAqIFxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiBvblN1Y2Nlc3M6ICgpID0+IHtcbiAqICAgaW52YWxpZGF0ZUFuZFJlZmV0Y2goW1wiL2FwaS9sb2FuLWl0ZW1zXCJdKTtcbiAqICAgaW52YWxpZGF0ZUFuZFJlZmV0Y2goW1wiL2FwaS9hZG1pbi9sb2FuLWl0ZW1zXCJdKTtcbiAqIH1cbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gaW52YWxpZGF0ZUFuZFJlZmV0Y2gocXVlcnlLZXk6IHJlYWRvbmx5IHVua25vd25bXSk6IHZvaWQge1xuICBxdWVyeUNsaWVudC5pbnZhbGlkYXRlUXVlcmllcyh7IHF1ZXJ5S2V5IH0pO1xuICAvLyBGb3JjZXIgbGUgcmFmcmHDrmNoaXNzZW1lbnQgaW1tw6lkaWF0IGRlcyBxdWVyaWVzIGFjdGl2ZXNcbiAgLy8gTsOpY2Vzc2FpcmUgY2FyIGludmFsaWRhdGVRdWVyaWVzIHNldWwgbmUgZm9yY2UgcGFzIGxlIHJlZmV0Y2ggc2kgc3RhbGVUaW1lIG4nZXN0IHBhcyBleHBpcsOpXG4gIHF1ZXJ5Q2xpZW50LnJlZmV0Y2hRdWVyaWVzKHsgcXVlcnlLZXkgfSk7XG59XG4iXSwibWFwcGluZ3MiOiJBQUFBLFNBQVMsbUJBQWtDO0FBQzNDLFNBQVMsc0JBQXNCO0FBRS9CLGVBQWUsZ0JBQWdCLEtBQWU7QUFDNUMsTUFBSSxDQUFDLElBQUksSUFBSTtBQUNYLFVBQU0sT0FBUSxNQUFNLElBQUksS0FBSyxLQUFNLElBQUk7QUFDdkMsVUFBTSxJQUFJLE1BQU0sR0FBRyxJQUFJLE1BQU0sS0FBSyxJQUFJLEVBQUU7QUFBQSxFQUMxQztBQUNGO0FBVUEsc0JBQXNCLFdBQ3BCLFFBQ0EsS0FDQSxNQUNtQjtBQUNuQixRQUFNLE1BQU0sTUFBTSxNQUFNLEtBQUs7QUFBQSxJQUMzQjtBQUFBLElBQ0EsU0FBUyxPQUFPLEVBQUUsZ0JBQWdCLG1CQUFtQixJQUFJLENBQUM7QUFBQSxJQUMxRCxNQUFNLE9BQU8sS0FBSyxVQUFVLElBQUksSUFBSTtBQUFBLElBQ3BDLGFBQWE7QUFBQSxFQUNmLENBQUM7QUFFRCxRQUFNLGdCQUFnQixHQUFHO0FBQ3pCLFNBQU87QUFDVDtBQTZCQSxzQkFBc0IsNkJBQ3BCLFFBQ0EsS0FDQSxNQUNtQjtBQUNuQixRQUFNLE1BQU0sTUFBTSxlQUFlLFFBQVEsS0FBSyxJQUFJO0FBR2xELE1BQUksSUFBSSxXQUFXLEtBQUs7QUFDdEIsVUFBTSxnQkFBZ0IsR0FBRztBQUFBLEVBQzNCO0FBRUEsU0FBTztBQUNUO0FBR08sYUFBTSxhQUdYLENBQUMsRUFBRSxPQUFPLHFCQUFxQixNQUMvQixPQUFPLEVBQUUsU0FBUyxNQUFNO0FBQ3RCLFFBQU0sTUFBTSxNQUFNLE1BQU0sU0FBUyxLQUFLLEdBQUcsR0FBYTtBQUFBLElBQ3BELGFBQWE7QUFBQSxFQUNmLENBQUM7QUFFRCxNQUFJLHlCQUF5QixnQkFBZ0IsSUFBSSxXQUFXLEtBQUs7QUFDL0QsV0FBTztBQUFBLEVBQ1Q7QUFFQSxRQUFNLGdCQUFnQixHQUFHO0FBQ3pCLFFBQU0sT0FBTyxNQUFNLElBQUksS0FBSztBQUc1QixNQUFJLFFBQVEsT0FBTyxTQUFTLFlBQVksYUFBYSxRQUFRLFVBQVUsTUFBTTtBQUMzRSxXQUFPLEtBQUs7QUFBQSxFQUNkO0FBRUEsU0FBTztBQUNUO0FBRUssYUFBTSxjQUFjLElBQUksWUFBWTtBQUFBLEVBQ3pDLGdCQUFnQjtBQUFBLElBQ2QsU0FBUztBQUFBLE1BQ1AsU0FBUyxXQUFXLEVBQUUsT0FBTyxRQUFRLENBQUM7QUFBQSxNQUN0QyxpQkFBaUI7QUFBQSxNQUNqQixzQkFBc0I7QUFBQTtBQUFBLE1BRXRCLFdBQVcsSUFBSSxLQUFLO0FBQUEsTUFDcEIsUUFBUSxLQUFLLEtBQUs7QUFBQSxNQUNsQixPQUFPO0FBQUEsTUFDUCxZQUFZLENBQUMsaUJBQXlCLEtBQUssSUFBSSxNQUFPLEtBQUssY0FBYyxHQUFLO0FBQUEsSUFDaEY7QUFBQSxJQUNBLFdBQVc7QUFBQSxNQUNULE9BQU87QUFBQSxJQUNUO0FBQUEsRUFDRjtBQUNGLENBQUM7QUFtQk0sZ0JBQVMscUJBQXFCLFVBQW9DO0FBQ3ZFLGNBQVksa0JBQWtCLEVBQUUsU0FBUyxDQUFDO0FBRzFDLGNBQVksZUFBZSxFQUFFLFNBQVMsQ0FBQztBQUN6QzsiLCJuYW1lcyI6W119