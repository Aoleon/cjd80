var _s = $RefreshSig$();
import __vite__cjsImport0_react from "/@fs/Users/thibault/Développements /CJD80/cjd80/node_modules/.vite/deps/react.js?v=8973d617"; const useState = __vite__cjsImport0_react["useState"]; const useEffect = __vite__cjsImport0_react["useEffect"];
import { PWAUtils } from "/src/lib/pwa-utils.ts";
import { getShortAppName } from "/src/config/branding.ts";
export function usePWAInstall() {
  _s();
  const [deferredPrompt, setDeferredPrompt] = useState(null);
  const [isInstallable, setIsInstallable] = useState(false);
  const [isInstalled, setIsInstalled] = useState(false);
  const [showPrompt, setShowPrompt] = useState(false);
  const [installResult, setInstallResult] = useState(null);
  const operatingSystem = PWAUtils.getOperatingSystem();
  const canInstall = PWAUtils.canInstallPWA();
  const browserInfo = PWAUtils.getBrowserInfo();
  const installInstructions = PWAUtils.getInstallInstructions();
  useEffect(() => {
    setIsInstalled(PWAUtils.isAppInstalled());
    const handleBeforeInstallPrompt = (e) => {
      e.preventDefault();
      const installEvent = e;
      setDeferredPrompt(installEvent);
      setIsInstallable(true);
      if (PWAUtils.isMobileDevice()) {
        setTimeout(() => {
          setShowPrompt(true);
        }, 3e3);
      }
    };
    const handleAppInstalled = () => {
      setIsInstalled(true);
      setDeferredPrompt(null);
      setIsInstallable(false);
      setShowPrompt(false);
      setInstallResult("success");
      PWAUtils.showNotification("Application installée !", {
        body: `${getShortAppName()} est maintenant disponible sur votre écran d'accueil`,
        icon: "/icon-192.svg"
      });
    };
    window.addEventListener("beforeinstallprompt", handleBeforeInstallPrompt);
    window.addEventListener("appinstalled", handleAppInstalled);
    return () => {
      window.removeEventListener("beforeinstallprompt", handleBeforeInstallPrompt);
      window.removeEventListener("appinstalled", handleAppInstalled);
    };
  }, []);
  const installApp = async () => {
    if (!deferredPrompt) {
      setShowPrompt(true);
      return;
    }
    setInstallResult("pending");
    try {
      await deferredPrompt.prompt();
      const { outcome } = await deferredPrompt.userChoice;
      if (outcome === "accepted") {
        setInstallResult("success");
        setShowPrompt(false);
      } else {
        setInstallResult("dismissed");
      }
      setDeferredPrompt(null);
      setIsInstallable(false);
    } catch (error) {
      console.error("Erreur lors de l'installation PWA:", error);
      setInstallResult("error");
    }
  };
  const showInstallPrompt = () => {
    setShowPrompt(true);
  };
  const hideInstallPrompt = () => {
    setShowPrompt(false);
    setInstallResult(null);
  };
  const shouldShowAutoPrompt = () => {
    if (isInstalled) return false;
    if (!browserInfo.supportsInstall) return false;
    if (PWAUtils.isMobileDevice() && canInstall) {
      const hasDeclined = localStorage.getItem("pwa-install-declined");
      return !hasDeclined;
    }
    return false;
  };
  const declineInstall = () => {
    localStorage.setItem("pwa-install-declined", "true");
    hideInstallPrompt();
  };
  return {
    // État
    isInstallable,
    isInstalled,
    showPrompt,
    installResult,
    // Informations système
    operatingSystem,
    canInstall,
    browserInfo,
    installInstructions,
    // Actions
    installApp,
    showInstallPrompt,
    hideInstallPrompt,
    declineInstall,
    shouldShowAutoPrompt,
    // Utilitaires
    isMobile: PWAUtils.isMobileDevice(),
    hasPromptEvent: !!deferredPrompt
  };
}
_s(usePWAInstall, "NtiW5zoLrKvcQWUFsX/1PpWmPpQ=");

//# sourceMappingURL=data:application/json;base64,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ZSxLQUFLWCxZQUFZO0FBRTNDLFlBQU04QixjQUFjQyxhQUFhQyxRQUFRLHNCQUFzQjtBQUMvRCxhQUFPLENBQUNGO0FBQUFBLElBQ1Y7QUFFQSxXQUFPO0FBQUEsRUFDVDtBQUdBLFFBQU1HLGlCQUFpQkEsTUFBTTtBQUMzQkYsaUJBQWFHLFFBQVEsd0JBQXdCLE1BQU07QUFDbkRQLHNCQUFrQjtBQUFBLEVBQ3BCO0FBRUEsU0FBTztBQUFBO0FBQUEsSUFFTHJDO0FBQUFBLElBQ0FFO0FBQUFBLElBQ0FFO0FBQUFBLElBQ0FFO0FBQUFBO0FBQUFBLElBR0FFO0FBQUFBLElBQ0FFO0FBQUFBLElBQ0FFO0FBQUFBLElBQ0FFO0FBQUFBO0FBQUFBLElBR0FnQjtBQUFBQSxJQUNBTTtBQUFBQSxJQUNBQztBQUFBQSxJQUNBTTtBQUFBQSxJQUNBTDtBQUFBQTtBQUFBQSxJQUdBTyxVQUFVbkQsU0FBUzJCLGVBQWU7QUFBQSxJQUNsQ3lCLGdCQUFnQixDQUFDLENBQUNoRDtBQUFBQSxFQUNwQjtBQUNGO0FBQUNELEdBL0llRCxlQUFhIiwibmFtZXMiOlsidXNlU3RhdGUiLCJ1c2VFZmZlY3QiLCJQV0FVdGlscyIsImdldFNob3J0QXBwTmFtZSIsInVzZVBXQUluc3RhbGwiLCJfcyIsImRlZmVycmVkUHJvbXB0Iiwic2V0RGVmZXJyZWRQcm9tcHQiLCJpc0luc3RhbGxhYmxlIiwic2V0SXNJbnN0YWxsYWJsZSIsImlzSW5zdGFsbGVkIiwic2V0SXNJbnN0YWxsZWQiLCJzaG93UHJvbXB0Iiwic2V0U2hvd1Byb21wdCIsImluc3RhbGxSZXN1bHQiLCJzZXRJbnN0YWxsUmVzdWx0Iiwib3BlcmF0aW5nU3lzdGVtIiwiZ2V0T3BlcmF0aW5nU3lzdGVtIiwiY2FuSW5zdGFsbCIsImNhbkluc3RhbGxQV0EiLCJicm93c2VySW5mbyIsImdldEJyb3dzZXJJbmZvIiwiaW5zdGFsbEluc3RydWN0aW9ucyIsImdldEluc3RhbGxJbnN0cnVjdGlvbnMiLCJpc0FwcEluc3RhbGxlZCIsImhhbmRsZUJlZm9yZUluc3RhbGxQcm9tcHQiLCJlIiwicHJldmVudERlZmF1bHQiLCJpbnN0YWxsRXZlbnQiLCJpc01vYmlsZURldmljZSIsInNldFRpbWVvdXQiLCJoYW5kbGVBcHBJbnN0YWxsZWQiLCJzaG93Tm90aWZpY2F0aW9uIiwiYm9keSIsImljb24iLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImluc3RhbGxBcHAiLCJwcm9tcHQiLCJvdXRjb21lIiwidXNlckNob2ljZSIsImVycm9yIiwiY29uc29sZSIsInNob3dJbnN0YWxsUHJvbXB0IiwiaGlkZUluc3RhbGxQcm9tcHQiLCJzaG91bGRTaG93QXV0b1Byb21wdCIsInN1cHBvcnRzSW5zdGFsbCIsImhhc0RlY2xpbmVkIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImRlY2xpbmVJbnN0YWxsIiwic2V0SXRlbSIsImlzTW9iaWxlIiwiaGFzUHJvbXB0RXZlbnQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZXMiOlsidXNlLXB3YS1pbnN0YWxsLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB1c2VTdGF0ZSwgdXNlRWZmZWN0IH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgUFdBVXRpbHMgfSBmcm9tICdAL2xpYi9wd2EtdXRpbHMnO1xuaW1wb3J0IHsgZ2V0U2hvcnRBcHBOYW1lIH0gZnJvbSAnQC9jb25maWcvYnJhbmRpbmcnO1xuXG5pbnRlcmZhY2UgQmVmb3JlSW5zdGFsbFByb21wdEV2ZW50IGV4dGVuZHMgRXZlbnQge1xuICBwcm9tcHQoKTogUHJvbWlzZTx2b2lkPjtcbiAgdXNlckNob2ljZTogUHJvbWlzZTx7IG91dGNvbWU6ICdhY2NlcHRlZCcgfCAnZGlzbWlzc2VkJyB9Pjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVzZVBXQUluc3RhbGwoKSB7XG4gIGNvbnN0IFtkZWZlcnJlZFByb21wdCwgc2V0RGVmZXJyZWRQcm9tcHRdID0gdXNlU3RhdGU8QmVmb3JlSW5zdGFsbFByb21wdEV2ZW50IHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IFtpc0luc3RhbGxhYmxlLCBzZXRJc0luc3RhbGxhYmxlXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2lzSW5zdGFsbGVkLCBzZXRJc0luc3RhbGxlZF0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtzaG93UHJvbXB0LCBzZXRTaG93UHJvbXB0XSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2luc3RhbGxSZXN1bHQsIHNldEluc3RhbGxSZXN1bHRdID0gdXNlU3RhdGU8J3BlbmRpbmcnIHwgJ3N1Y2Nlc3MnIHwgJ2Rpc21pc3NlZCcgfCAnZXJyb3InIHwgbnVsbD4obnVsbCk7XG5cbiAgY29uc3Qgb3BlcmF0aW5nU3lzdGVtID0gUFdBVXRpbHMuZ2V0T3BlcmF0aW5nU3lzdGVtKCk7XG4gIGNvbnN0IGNhbkluc3RhbGwgPSBQV0FVdGlscy5jYW5JbnN0YWxsUFdBKCk7XG4gIGNvbnN0IGJyb3dzZXJJbmZvID0gUFdBVXRpbHMuZ2V0QnJvd3NlckluZm8oKTtcbiAgY29uc3QgaW5zdGFsbEluc3RydWN0aW9ucyA9IFBXQVV0aWxzLmdldEluc3RhbGxJbnN0cnVjdGlvbnMoKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIC8vIFbDqXJpZmllciBzaSBsJ2FwcCBlc3QgZMOpasOgIGluc3RhbGzDqWVcbiAgICBzZXRJc0luc3RhbGxlZChQV0FVdGlscy5pc0FwcEluc3RhbGxlZCgpKTtcblxuICAgIC8vIEfDqXJlciBsJ8OpdsOpbmVtZW50IGJlZm9yZWluc3RhbGxwcm9tcHQgKEFuZHJvaWQvRGVza3RvcClcbiAgICBjb25zdCBoYW5kbGVCZWZvcmVJbnN0YWxsUHJvbXB0ID0gKGU6IEV2ZW50KSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBjb25zdCBpbnN0YWxsRXZlbnQgPSBlIGFzIEJlZm9yZUluc3RhbGxQcm9tcHRFdmVudDtcbiAgICAgIHNldERlZmVycmVkUHJvbXB0KGluc3RhbGxFdmVudCk7XG4gICAgICBzZXRJc0luc3RhbGxhYmxlKHRydWUpO1xuICAgICAgXG4gICAgICAvLyBBZmZpY2hlciBhdXRvbWF0aXF1ZW1lbnQgbGUgcHJvbXB0IHN1ciBtb2JpbGUgKGFwcsOocyAzIHNlY29uZGVzKVxuICAgICAgaWYgKFBXQVV0aWxzLmlzTW9iaWxlRGV2aWNlKCkpIHtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgc2V0U2hvd1Byb21wdCh0cnVlKTtcbiAgICAgICAgfSwgMzAwMCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8vIEfDqXJlciBsJ2luc3RhbGxhdGlvbiByw6l1c3NpZVxuICAgIGNvbnN0IGhhbmRsZUFwcEluc3RhbGxlZCA9ICgpID0+IHtcbiAgICAgIHNldElzSW5zdGFsbGVkKHRydWUpO1xuICAgICAgc2V0RGVmZXJyZWRQcm9tcHQobnVsbCk7XG4gICAgICBzZXRJc0luc3RhbGxhYmxlKGZhbHNlKTtcbiAgICAgIHNldFNob3dQcm9tcHQoZmFsc2UpO1xuICAgICAgc2V0SW5zdGFsbFJlc3VsdCgnc3VjY2VzcycpO1xuICAgICAgXG4gICAgICAvLyBOb3RpZmljYXRpb24gZGUgc3VjY8Ooc1xuICAgICAgUFdBVXRpbHMuc2hvd05vdGlmaWNhdGlvbignQXBwbGljYXRpb24gaW5zdGFsbMOpZSAhJywge1xuICAgICAgICBib2R5OiBgJHtnZXRTaG9ydEFwcE5hbWUoKX0gZXN0IG1haW50ZW5hbnQgZGlzcG9uaWJsZSBzdXIgdm90cmUgw6ljcmFuIGQnYWNjdWVpbGAsXG4gICAgICAgIGljb246ICcvaWNvbi0xOTIuc3ZnJ1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdiZWZvcmVpbnN0YWxscHJvbXB0JywgaGFuZGxlQmVmb3JlSW5zdGFsbFByb21wdCk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2FwcGluc3RhbGxlZCcsIGhhbmRsZUFwcEluc3RhbGxlZCk7XG5cbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2JlZm9yZWluc3RhbGxwcm9tcHQnLCBoYW5kbGVCZWZvcmVJbnN0YWxsUHJvbXB0KTtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdhcHBpbnN0YWxsZWQnLCBoYW5kbGVBcHBJbnN0YWxsZWQpO1xuICAgIH07XG4gIH0sIFtdKTtcblxuICAvLyBGb25jdGlvbiBwb3VyIGTDqWNsZW5jaGVyIGwnaW5zdGFsbGF0aW9uXG4gIGNvbnN0IGluc3RhbGxBcHAgPSBhc3luYyAoKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgaWYgKCFkZWZlcnJlZFByb21wdCkge1xuICAgICAgLy8gUG91ciBpT1Mgb3Ugc2kgcGFzIGRlIHByb21wdCBkaXNwb25pYmxlLCBhZmZpY2hlciBsZXMgaW5zdHJ1Y3Rpb25zXG4gICAgICBzZXRTaG93UHJvbXB0KHRydWUpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHNldEluc3RhbGxSZXN1bHQoJ3BlbmRpbmcnKTtcblxuICAgIHRyeSB7XG4gICAgICBhd2FpdCBkZWZlcnJlZFByb21wdC5wcm9tcHQoKTtcbiAgICAgIGNvbnN0IHsgb3V0Y29tZSB9ID0gYXdhaXQgZGVmZXJyZWRQcm9tcHQudXNlckNob2ljZTtcbiAgICAgIFxuICAgICAgaWYgKG91dGNvbWUgPT09ICdhY2NlcHRlZCcpIHtcbiAgICAgICAgc2V0SW5zdGFsbFJlc3VsdCgnc3VjY2VzcycpO1xuICAgICAgICBzZXRTaG93UHJvbXB0KGZhbHNlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNldEluc3RhbGxSZXN1bHQoJ2Rpc21pc3NlZCcpO1xuICAgICAgfVxuICAgICAgXG4gICAgICBzZXREZWZlcnJlZFByb21wdChudWxsKTtcbiAgICAgIHNldElzSW5zdGFsbGFibGUoZmFsc2UpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJldXIgbG9ycyBkZSBsXFwnaW5zdGFsbGF0aW9uIFBXQTonLCBlcnJvcik7XG4gICAgICBzZXRJbnN0YWxsUmVzdWx0KCdlcnJvcicpO1xuICAgIH1cbiAgfTtcblxuICAvLyBGb25jdGlvbiBwb3VyIGFmZmljaGVyIG1hbnVlbGxlbWVudCBsZSBwcm9tcHRcbiAgY29uc3Qgc2hvd0luc3RhbGxQcm9tcHQgPSAoKSA9PiB7XG4gICAgc2V0U2hvd1Byb21wdCh0cnVlKTtcbiAgfTtcblxuICAvLyBGb25jdGlvbiBwb3VyIG1hc3F1ZXIgbGUgcHJvbXB0XG4gIGNvbnN0IGhpZGVJbnN0YWxsUHJvbXB0ID0gKCkgPT4ge1xuICAgIHNldFNob3dQcm9tcHQoZmFsc2UpO1xuICAgIHNldEluc3RhbGxSZXN1bHQobnVsbCk7XG4gIH07XG5cbiAgLy8gVsOpcmlmaWVyIHNpIG9uIGRvaXQgYWZmaWNoZXIgbGUgcHJvbXB0IGF1dG9tYXRpcXVlbWVudFxuICBjb25zdCBzaG91bGRTaG93QXV0b1Byb21wdCA9ICgpOiBib29sZWFuID0+IHtcbiAgICAvLyBOZSBwYXMgYWZmaWNoZXIgc2kgZMOpasOgIGluc3RhbGzDqVxuICAgIGlmIChpc0luc3RhbGxlZCkgcmV0dXJuIGZhbHNlO1xuICAgIFxuICAgIC8vIE5lIHBhcyBhZmZpY2hlciBzaSBsZSBuYXZpZ2F0ZXVyIG5lIHN1cHBvcnRlIHBhc1xuICAgIGlmICghYnJvd3NlckluZm8uc3VwcG9ydHNJbnN0YWxsKSByZXR1cm4gZmFsc2U7XG4gICAgXG4gICAgLy8gQWZmaWNoZXIgc2kgYydlc3QgbW9iaWxlIGV0IHF1J29uIHBldXQgaW5zdGFsbGVyXG4gICAgaWYgKFBXQVV0aWxzLmlzTW9iaWxlRGV2aWNlKCkgJiYgY2FuSW5zdGFsbCkge1xuICAgICAgLy8gVsOpcmlmaWVyIHNpIGwndXRpbGlzYXRldXIgbidhIHBhcyBkw6lqw6AgcmVmdXPDqSAobG9jYWxTdG9yYWdlKVxuICAgICAgY29uc3QgaGFzRGVjbGluZWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncHdhLWluc3RhbGwtZGVjbGluZWQnKTtcbiAgICAgIHJldHVybiAhaGFzRGVjbGluZWQ7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICAvLyBNYXJxdWVyIGNvbW1lIHJlZnVzw6kgKG5lIHBsdXMgcHJvcG9zZXIpXG4gIGNvbnN0IGRlY2xpbmVJbnN0YWxsID0gKCkgPT4ge1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwd2EtaW5zdGFsbC1kZWNsaW5lZCcsICd0cnVlJyk7XG4gICAgaGlkZUluc3RhbGxQcm9tcHQoKTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIC8vIMOJdGF0XG4gICAgaXNJbnN0YWxsYWJsZSxcbiAgICBpc0luc3RhbGxlZCxcbiAgICBzaG93UHJvbXB0LFxuICAgIGluc3RhbGxSZXN1bHQsXG4gICAgXG4gICAgLy8gSW5mb3JtYXRpb25zIHN5c3TDqG1lXG4gICAgb3BlcmF0aW5nU3lzdGVtLFxuICAgIGNhbkluc3RhbGwsXG4gICAgYnJvd3NlckluZm8sXG4gICAgaW5zdGFsbEluc3RydWN0aW9ucyxcbiAgICBcbiAgICAvLyBBY3Rpb25zXG4gICAgaW5zdGFsbEFwcCxcbiAgICBzaG93SW5zdGFsbFByb21wdCxcbiAgICBoaWRlSW5zdGFsbFByb21wdCxcbiAgICBkZWNsaW5lSW5zdGFsbCxcbiAgICBzaG91bGRTaG93QXV0b1Byb21wdCxcbiAgICBcbiAgICAvLyBVdGlsaXRhaXJlc1xuICAgIGlzTW9iaWxlOiBQV0FVdGlscy5pc01vYmlsZURldmljZSgpLFxuICAgIGhhc1Byb21wdEV2ZW50OiAhIWRlZmVycmVkUHJvbXB0XG4gIH07XG59Il0sImZpbGUiOiIvVXNlcnMvdGhpYmF1bHQvRGXMgXZlbG9wcGVtZW50cyAvQ0pEODAvY2pkODAvY2xpZW50L3NyYy9ob29rcy91c2UtcHdhLWluc3RhbGwudHN4In0=